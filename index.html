<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simple Data Table</title>
  <script src="./assets/dataTable/script.js"></script>
  <script src="./assets/jquery/jquery-3.6.1.min.js"></script>
  <script src="./assets/moment.2.29.4.js"></script>
  <link rel="stylesheet" href="./assets/dataTable/style.css">
  <link rel="stylesheet" href="./style.css">
</head>

<body class="dark" style="width: 100%;">
  <div class="container">
    <span onclick='$("body").toggleClass("dark");'>Change dark or light</span>
    <h1>V2.0.0</h1>
    <h2>ray table</h2>
    <div>
      <div>
        <!-- <button onclick="createNew()">Add New</button>
        <button onclick="updateData()">Update</button>
        <button onclick="deleteData()">Delete</button> -->
        <div id="theTable"></div>
      </div>
    </div>
    <script>
      function updateData() {
        table.updateIndex(2, {
          name: 'Change'
          , age: 30
        })
      }

      function deleteData() {
        table.deleteIndex(1)
      }

      function createNew() {
        table.addData({
          id: 12
          , age: 18
          , name: 'Oxy Thu'
          , rs: false
          , profile_image_url: 'https://avatars.githubusercontent.com/u/65397559?v=4'
        })
      }
      var tableSetting = {
        api: `https://myanmarenduser.com/wp-json/wp/v2/posts/?_fields=link,id,title,date,_links,excerpt,categories&_embed=wp:featuredmedia&${window.location.search.substring(1)}`
        , element: '#theTable'
          // , data: users
        , caption: "DVB News"
        , cols: [{
            key: 'image'
            , label: "Poster"
            , render: (r) => {
              var media = r._embedded['wp:featuredmedia'] == undefined ? null : r._embedded['wp:featuredmedia'][0].media_details;
              var errPhotoUrl = 'https://static.vecteezy.com/system/resources/thumbnails/004/141/669/small/no-photo-or-blank-image-icon-loading-images-or-missing-image-mark-image-not-available-or-image-coming-soon-sign-simple-nature-silhouette-in-frame-isolated-illustration-vector.jpg';
              var photoUrl = media ? `https://myanmarenduser.com/${media.sizes.thumbnail?.source_url}` : errPhotoUrl;
              return `<img src="${photoUrl}"  alt="${r.title.rendered}" style="height:80px;aspect-ratio: 5 / 3;object-fit:cover" onerror="this.src='${errPhotoUrl}';" />`
            }
          }
          , {
            key: 'date'
            , label: 'post on'
            , render: (data) => moment(data.date)
              .format("DD-MMM YYYY<br/>hh:mm a")
          }
          , {
            key: 'link'
            , sort: false
            , label: 'News Title'
            , render: (r) => {
              var link = r.link;
              return `
              ${r.title.rendered}<br/>
              <a class="h4" target="_blank" href="${link}">${link}</a>
              `
            }
          }
        ]
        , defaultHide: ['id']
      };

      // load table with out data
      const table = new TheTable(tableSetting);
    </script>
  </div>
</body>

</html>
